# Business Logic — Personal Assistant CLI
## Презентаційна версія

---

## 🎯 Призначення проєкту

**Personal Assistant CLI** — консольний застосунок для централізованого управління особистою інформацією:
- 👥 Контакти (адресна книга)
- 📝 Нотатки з тегами

**Цільова аудиторія:**
- Користувачі командного рядка
- Розробники та IT-спеціалісти
- Люди, що цінують приватність (локальне зберігання)
- Прихильники мінімалістичних інструментів

---

## 📋 Основна бізнес-логіка

### Принцип роботи

```
┌─────────────┐
│   Користувач │
└──────┬──────┘
       │ Команди (текстовий ввід)
       ▼
┌─────────────────┐
│  CLI Interface  │ ◄── Парсинг та валідація
└────────┬────────┘
         │
    ┌────┴────┐
    ▼         ▼
┌─────────┐ ┌─────────┐
│ Contacts│ │  Notes  │ ◄── Бізнес-об'єкти
└────┬────┘ └────┬────┘
     │           │
     └─────┬─────┘
           ▼
    ┌──────────────┐
    │   Storage    │ ◄── Персистентність
    │ (JSON files) │
    └──────────────┘
```

---

## 👥 Управління контактами

### Життєвий цикл контакту

```
Створення → Зберігання → Пошук → Редагування → Видалення
    ↓           ↓          ↓          ↓            ↓
Валідація   Auto-save   Flexible   Validation   Confirmation
```

### Структура контакту

```python
Contact {
    name: string         # Обов'язкове, унікальне
    phones: [string]     # 0..N телефонів
    email: string?       # Опціонально
    address: string?     # Опціонально
    birthday: date?      # Опціонально (YYYY-MM-DD)
}
```

### Бізнес-правила контактів

1. **Унікальність:** Ім'я контакту — унікальний ключ (case-insensitive)
2. **Валідація телефонів:** 
   - 7-15 цифр
   - Опціональний '+' на початку
   - Автоматичне видалення пробілів
3. **Валідація email:** RFC-подібний формат
4. **Множинність телефонів:** Один контакт може мати декілька номерів
5. **Обчислення віку:** Автоматичний підрахунок днів до дня народження

### Сценарії використання (Contacts)

#### UC-1: Додавання контакту
```
Вхід: Ім'я + деталі (phone, email, address, birthday)
Валідація: Перевірка формату всіх полів
Результат: Контакт збережено або повідомлення про помилку
```

#### UC-2: Пошук контактів
```
Вхід: Пошуковий запит (текст)
Логіка: Пошук у всіх полях (name, phones, email, address)
Результат: Список збігів
```

#### UC-3: Нагадування про дні народження
```
Вхід: Кількість днів наперед
Логіка: 
  - Перенести дату народження на поточний рік
  - Якщо вже минула → наступний рік
  - Відфільтрувати за діапазоном
Результат: Список контактів із днями до святкування
```

---

## 📝 Управління нотатками

### Життєвий цикл нотатки

```
Створення → Додавання тегів → Пошук → Редагування → Сортування → Видалення
    ↓            ↓               ↓          ↓             ↓            ↓
  Title      Normalize      Multi-field   Flexible    By tags      Confirm
```

### Структура нотатки

```python
Note {
    title: string           # Обов'язкове, унікальне
    content: string         # Текст нотатки
    tags: Set[string]       # Множина тегів (lowercase)
}
```

### Бізнес-правила нотаток

1. **Унікальність:** Заголовок — унікальний ключ (case-insensitive)
2. **Теги:**
   - Нормалізовані (lowercase, trim)
   - Автоматична дедуплікація (Set)
   - Можна додавати/видаляти динамічно
3. **Пошук:** За заголовком, вмістом або тегами
4. **Сортування:** Спочатку за тегами, потім за назвою

### Сценарії використання (Notes)

#### UC-4: Створення нотатки з тегами
```
Вхід: Title + content + tags (comma-separated)
Логіка: 
  - Нормалізація тегів (lowercase, trim)
  - Створення множини (дедуплікація)
Результат: Нотатка збережена
```

#### UC-5: Пошук нотаток за тегом
```
Вхід: Тег для фільтрації
Логіка: Точний збіг тегу
Результат: Відсортований список нотаток
```

#### UC-6: Сортування нотаток
```
Логіка:
  1. Групування за тегами (алфавітно)
  2. Всередині групи — за назвою
Результат: Структурований список
```

---

## 🔄 Бізнес-процеси

### 1. Життєвий цикл сесії

```
┌─────────────────────────────────────┐
│ 1. Запуск застосунку                │
│    → Завантаження даних з диску     │
└──────────────┬──────────────────────┘
               ▼
┌─────────────────────────────────────┐
│ 2. Інтерактивний режим (REPL)       │
│    → Введення команд                │
│    → Виконання операцій             │
│    → Автоматичне збереження         │
└──────────────┬──────────────────────┘
               ▼
┌─────────────────────────────────────┐
│ 3. Вихід (exit/quit/Ctrl+D)         │
│    → Graceful shutdown              │
└─────────────────────────────────────┘
```

### 2. Обробка команди

```
Введення тексту
    ↓
Парсинг команди
    ↓
Валідація синтаксису
    ↓
Виконання бізнес-логіки
    ↓
Валідація даних
    ↓
Збереження змін (auto-save)
    ↓
Повернення результату користувачу
```

### 3. Валідація даних (Multi-layer)

```
┌────────────────────┐
│ Layer 1: Syntax    │ ← Парсинг команди
└─────────┬──────────┘
          ▼
┌────────────────────┐
│ Layer 2: Business  │ ← Перевірка існування
└─────────┬──────────┘
          ▼
┌────────────────────┐
│ Layer 3: Data      │ ← Regex валідація
└─────────┬──────────┘
          ▼
    ✅ Успішно
```

---

## 💾 Персистентність (Storage Logic)

### Стратегія збереження

**Auto-save після кожної операції зміни:**
```
add_contact    → save()
edit_contact   → save()
delete_contact → save()
add_note       → save()
edit_note      → save()
delete_note    → save()

# Операції читання НЕ викликають save()
list_contacts  → no save
search_notes   → no save
```

### Формат зберігання

```
~/.personal_assistant/
├── contacts.json    ← Всі контакти (array of objects)
└── notes.json       ← Всі нотатки (array of objects)
```

**Переваги підходу:**
- ✅ Захист від втрати даних (auto-save)
- ✅ Читабельний формат (JSON)
- ✅ Легкий backup (просто скопіювати файли)
- ✅ Переносимість між платформами

---

## 🔍 Пошукова логіка

### Алгоритм пошуку контактів

```python
def search_contacts(query):
    results = []
    query_lower = query.lower()  # Case-insensitive
    
    for contact in all_contacts:
        # Пошук у всіх текстових полях
        if (query_lower in contact.name.lower() OR
            query_lower in contact.email.lower() OR
            query_lower in contact.address.lower() OR
            any(query_lower in phone for phone in contact.phones)):
            results.append(contact)
    
    return results
```

**Особливості:**
- Часткове співпадіння (substring)
- Пошук у всіх полях одночасно
- Case-insensitive
- Складність: O(n × m), де n — кількість контактів, m — довжина запиту

### Алгоритм пошуку нотаток

```python
def search_notes(query):
    results = []
    query_lower = query.lower()
    
    for note in all_notes:
        # Пошук у заголовку, вмісті та тегах
        if (query_lower in note.title.lower() OR
            query_lower in note.content.lower() OR
            any(query_lower in tag for tag in note.tags)):
            results.append(note)
    
    return results
```

---

## 🎂 Бізнес-логіка днів народження

### Алгоритм обчислення

```python
def days_to_birthday(contact, today):
    if not contact.birthday:
        return None  # Немає дня народження
    
    # Крок 1: Перенести дату на поточний рік
    birthday_this_year = contact.birthday.replace(year=today.year)
    
    # Крок 2: Якщо вже минула → наступний рік
    if birthday_this_year < today:
        birthday_this_year = birthday_this_year.replace(year=today.year + 1)
    
    # Крок 3: Обчислити різницю
    delta = birthday_this_year - today
    return delta.days
```

### Приклади

```
Сьогодні: 2024-11-13
День народження: 1990-03-15

Крок 1: 2024-03-15
Крок 2: 2024-03-15 < 2024-11-13 → 2025-03-15
Крок 3: 122 дні до дня народження
```

**Фільтрація:**
```python
upcoming = [c for c in contacts 
            if 0 <= days_to_birthday(c, today) <= days_ahead]
```

---

## 🏷️ Логіка тегів

### Нормалізація тегів

```python
def add_tags(note, tags_list):
    for tag in tags_list:
        clean_tag = tag.strip().lower()  # Очистити та lowercase
        if clean_tag:  # Якщо не порожній
            note.tags.add(clean_tag)  # Set автоматично дедуплікує
```

### Приклади нормалізації

```
Вхід:     "Work", "WORK", "  work  ", "Personal"
Результат: {"work", "personal"}  # Дедупліковані та normalized
```

### Пошук за тегом

```python
def search_by_tag(notebook, target_tag):
    target_tag = target_tag.strip().lower()  # Нормалізувати запит
    results = [note for note in notebook 
               if target_tag in note.tags]  # O(1) пошук у Set
    return sorted(results, key=lambda n: n.title)
```

---

## 🛡️ Валідація та обробка помилок

### Рівні валідації

#### 1. Синтаксична валідація
```
Команда розпізнана? → Якщо НІ → підказка схожої команди
Аргументи присутні? → Якщо НІ → повідомлення про usage
```

#### 2. Бізнес-валідація
```
Контакт існує? → для edit/delete/show
Нотатка існує? → для edit/delete/show
Унікальність → при створенні
```

#### 3. Валідація даних
```
Телефон → regex pattern
Email → regex pattern
Дата → strptime parsing
```

### Стратегія обробки помилок

```python
try:
    # Виконання команди
    result = execute_command(input)
except CommandError as e:
    # Очікувана помилка (користувач)
    print(f"Error: {e}")
    continue  # Не падаємо, продовжуємо роботу
except ValidationError as e:
    # Помилка валідації даних
    print(f"Validation error: {e}")
    continue
except Exception as e:
    # Непередбачена помилка
    print(f"Unexpected error: {e}")
    continue
```

**Принцип: Graceful degradation**
- Програма НІКОЛИ не падає при помилках користувача
- Зрозумілі повідомлення про помилки
- Підказки для виправлення

---

## 💡 Інтелектуальні фічі

### 1. Підказки команд

```python
Користувач вводить: "ad contact John"
Система: "Unknown command. Did you mean 'add contact'?"

Алгоритм: difflib.get_close_matches(input, all_commands, cutoff=0.5)
```

### 2. Case-insensitive все

```python
"Show Contact ALICE" == "show contact alice" == "SHOW CONTACT Alice"
# Працює однаково завдяки нормалізації
```

### 3. Гнучке редагування телефонів

```python
# Додати новий
edit contact John phone=+380501234567

# Замінити існуючий
edit contact John phone=+380501234567:+380991234567
                             ↑
                        old:new syntax
```

### 4. Множинні телефони при створенні

```python
add contact John phone1=+380501234567 phone2=+380671112233
                  ↑                    ↑
             Будь-який ключ, що починається з "phone"
```

---

## 📊 Бізнес-метрики та обмеження

### Поточні обмеження

| Обмеження | Значення | Обґрунтування |
|-----------|----------|---------------|
| Максимум контактів | ~1000 | O(n) пошук без індексів |
| Максимум нотаток | ~1000 | O(n) пошук без індексів |
| Розмір JSON файлу | ~1-5 MB | Швидке завантаження в пам'ять |
| Одночасні користувачі | 1 | Немає file locking |

### Масштабованість

**Для збільшення обсягів:**
1. Міграція на SQLite (індекси, транзакції)
2. Пагінація результатів
3. Ледаче завантаження даних
4. File locking для concurrent access

---

## 🎯 Конкурентні переваги

### Чому обрати Personal Assistant CLI?

✅ **Приватність**
- Всі дані локально (не в хмарі)
- Контроль над backup
- Немає реєстрації/логіна

✅ **Простота**
- Мінімалістичний інтерфейс
- Інтуїтивні команди
- Zero configuration

✅ **Швидкість**
- Миттєвий запуск
- Швидкий пошук (in-memory)
- Автоматичне збереження

✅ **Надійність**
- Не падає при помилках
- Auto-save після кожної операції
- Читабельний формат backup (JSON)

✅ **Портативність**
- Працює на Linux/macOS/Windows
- Не потребує зовнішніх залежностей
- Легко переносити дані

---

## 🚀 Use Cases (Реальне використання)

### Сценарій 1: Фрілансер
```
1. Додає клієнтів як контакти (email, phone, адреса офісу)
2. Створює нотатки до кожного проєкту з тегами (client-name, urgent)
3. Швидко шукає контакти за частиною email
4. Сортує нотатки за тегами для огляду задач
```

### Сценарій 2: Студент
```
1. Зберігає контакти однокурсників і викладачів
2. Веде нотатки з лекцій з тегами (course-name, exam)
3. Підказки про дні народження друзів
4. Пошук нотаток за ключовими словами перед іспитом
```

### Сценарій 3: Розробник
```
1. Зберігає контакти колег з різних команд
2. Нотатки про code snippets, ідеї, bug notes
3. Теги: bug, feature, idea, meeting
4. Швидкий пошук через термінал (не виходячи з CLI)
```

---

## 📈 Майбутні бізнес-можливості

### MVP Extensions
1. **Експорт контактів** → vCard, CSV (інтеграція з іншими застосунками)
2. **Імпорт даних** → з Google Contacts, Outlook
3. **Нагадування** → cron jobs для email notification про дні народження
4. **Шифрування** → GPG для захисту sensitive information

### Advanced Features
1. **REST API** → інтеграція з mobile apps
2. **Web UI** → для non-CLI користувачів
3. **Cloud sync** → опціональна синхронізація
4. **Team collaboration** → shared notebooks

---

## 🏁 Висновок: Бізнес-логіка

### Ключові принципи

🎯 **Simplicity First**
- Прості, зрозумілі команди
- Мінімальна конфігурація
- Immediate feedback

🛡️ **Reliability & Safety**
- Валідація на всіх рівнях
- Автоматичне збереження
- Graceful error handling

🚀 **User Experience**
- Інтелектуальні підказки
- Case-insensitive пошук
- Гнучкі команди редагування

💾 **Data Integrity**
- Auto-save після змін
- Читабельний формат backup
- Простота міграції даних

🌱 **Extensibility**
- Модульна архітектура
- Легко додавати функції
- Готовий до масштабування

---

**Personal Assistant CLI** — це не просто застосунок для контактів і нотаток.

Це **філософія простоти**, **надійності** та **контролю над власними даними**. 🎯

